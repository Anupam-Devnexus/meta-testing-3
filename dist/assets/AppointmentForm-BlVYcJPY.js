import{p as I,a as N,j as o}from"./index-ePZmuw5s.js";import{u as T,r as h}from"./react-DNgDP3D6.js";import{y as v}from"./index-zxlf4DXA.js";/* empty css                      */import"./charts-CZ9u0xu3.js";const j="https://dbbackend.devnexussolutions.com/auth/api/appointment",$=I(a=>({appointments:[],loading:!1,error:null,fetchAppointments:async()=>{a({loading:!0,error:null});try{const t=localStorage.getItem("UserDetails"),e=t?JSON.parse(t).token:null;if(!e)throw new Error("No token found. Please login.");const s=await N.get(j,{headers:{Authorization:`Bearer ${e}`}});a({appointments:s.data||[],loading:!1}),console.log("Fetched appointments:",s.data)}catch(t){console.error("Error fetching appointments:",t),a({error:t.response?.data?.message||t.message||"Something went wrong",loading:!1})}},addAppointment:async t=>{a({loading:!0,error:null});try{const e=localStorage.getItem("userDetails"),s=e?JSON.parse(e).token:null;if(!s)throw new Error("No token found. Please login.");console.log("Posting appointment:",t);const d=await N.post(j,t,{headers:{Authorization:`Bearer ${s}`}});a(c=>({appointments:[...c.appointments,d.data],loading:!1})),console.log("Appointment added:",d.data)}catch(e){console.error("Error adding appointment:",e),a({error:e.response?.data?.message||e.message||"Something went wrong",loading:!1})}}})),B=()=>{const a=T(),{addAppointment:t}=$(),[e,s]=h.useState({title:"",date:"",time:"",duration:"30",description:"",emails:""}),[d,c]=h.useState(""),[f,i]=h.useState(""),A="https://dbbackend.devnexussolutions.com/auth/api/appointment",r=u=>{const{name:l,value:p}=u.target;s(m=>({...m,[l]:p}))},D=async u=>{u.preventDefault();const{title:l,date:p,time:m,duration:E,description:C,emails:P}=e;if(!l||!p||!m){i("Please fill all mandatory fields.");return}const x=P.split(/[,;\s]+/).filter(n=>n.trim()!==""),b=x.filter(n=>!/^\S+@\S+\.\S+$/.test(n));if(b.length>0){i(`Invalid email(s): ${b.join(", ")}`);return}i("");const S=`https://meet.google.com/${Math.random().toString(36).substring(2,11)}`,w={title:l,date:p,time:m,duration:E,description:C,emails:x,meetLink:S};console.log("Posting appointment:",w);try{const n=localStorage.getItem("userDetails"),k=n?JSON.parse(n).token:null,y=await fetch(A,{method:"POST",headers:{"Content-Type":"application/json",Authorization:k?`Bearer ${k}`:""},body:JSON.stringify(w)}),g=await y.json();if(console.log("API Response:",g),!y.ok)throw new Error(g.message||"Failed to create appointment");t(g),v.success("Appointment booked successfully!",{position:"top-right",autoClose:3e3}),a("/admin-dashboard/appointments"),c(S),s({title:"",date:"",time:"",duration:"30",description:"",emails:""})}catch(n){console.error("Error posting appointment:",n),i(n.message||"Something went wrong"),v.error(n.message||"Failed to book appointment",{position:"top-right",autoClose:3e3})}};return o.jsxs("form",{onSubmit:D,className:"bg-white shadow-md rounded-lg p-6 w-full max-w-3xl mx-auto flex flex-col gap-4",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Schedule Appointment"}),f&&o.jsx("p",{className:"text-red-500",children:f}),o.jsx("input",{type:"text",name:"title",placeholder:"Appointment Title *",value:e.title,onChange:r,className:"border p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"date",name:"date",value:e.date,onChange:r,className:"border p-2 rounded-md flex-1 focus:outline-none focus:ring-2 focus:ring-blue-400"}),o.jsx("input",{type:"time",name:"time",value:e.time,onChange:r,className:"border p-2 rounded-md flex-1 focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),o.jsx("input",{type:"number",min:"5",name:"duration",placeholder:"Duration (minutes)",value:e.duration,onChange:r,className:"border p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),o.jsx("textarea",{name:"description",placeholder:"Description (optional)",value:e.description,onChange:r,className:"border p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),o.jsx("input",{type:"text",name:"emails",placeholder:"Invite Emails (comma, semicolon, or space separated)",value:e.emails,onChange:r,className:"border p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),o.jsx("button",{type:"submit",className:"bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 transition",children:"Schedule Appointment"})]})};export{B as default};

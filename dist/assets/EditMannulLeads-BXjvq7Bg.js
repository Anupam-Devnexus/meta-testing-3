import{j as e}from"./index-ePZmuw5s.js";import{i as j,u as y,r as d}from"./react-DNgDP3D6.js";import{u as N}from"./LeadsGet-C2X5tLaH.js";import{u as w}from"./UsersGet-DoIcZEnz.js";function q(){const{leadId:r}=j(),m=y(),{data:i,loading:h,error:c,fetchData:b}=N(),{users:f,fetchUser:p}=w(),[a,u]=d.useState({name:"",email:"",phone:"",city:"",requirement:"",assignedTo:"",assignedDate:"",status:""});if(d.useEffect(()=>{b(),p()},[]),d.useEffect(()=>{if(i?.leads){const s=i.leads.find(o=>o._id===r);s&&u({name:s.name||"",email:s.email||"",phone:s.phone||"",city:s.city||"",requirement:s.requirement||"",assignedTo:s.assignedTo||"",assignedDate:s.assignedDate?s.assignedDate.slice(0,10):"",status:s.status||""})}},[i,r]),h)return e.jsx("p",{className:"text-center text-gray-600 mt-20 text-lg font-medium",children:"Loading..."});if(c)return e.jsxs("p",{className:"text-center text-red-600 mt-20 text-lg font-medium",children:["Error: ",c]});const g=f?.users?.filter(s=>s.role==="admin")||[],n=s=>{const{name:o,value:l}=s.target;u(t=>({...t,[o]:l}))},x=async s=>{s.preventDefault();const o=`https://dbbackend.devnexussolutions.com/auth/api/get-all-leads/edit/${r}`,l=JSON.parse(localStorage.getItem("UserDetails"))?.token;if(!l){alert("User not authenticated. Please log in.");return}console.log("PATCH request to:",o),console.log("Payload being sent:",a);try{const t=await fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(a),credentials:"include"});if(!t.ok)throw new Error("Failed to update lead");await t.json(),alert("Lead updated successfully!"),m("/admin-dashboard/mannual-leads")}catch(t){console.error("Error updating lead:",t),alert("An error occurred while updating the lead.")}};return e.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white shadow-lg rounded-lg mt-10 sm:mt-16",children:[e.jsxs("h1",{className:"text-3xl font-extrabold mb-8 text-gray-800 text-center sm:text-left",children:["Edit Lead: ",e.jsx("span",{className:"text-blue-600",children:a.name})]}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:a.name,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Full Name",required:!0})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:a.email,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"example@email.com",required:!0})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"+91 9876543210",required:!0})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:a.city,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"City"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Requirement"}),e.jsx("input",{type:"text",name:"requirement",value:a.requirement,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:"Requirement details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Assigned To"}),e.jsxs("select",{name:"assignedTo",value:a.assignedTo,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",children:[e.jsx("option",{value:"",children:"-- Select Admin --"}),g.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Assigned Date"}),e.jsx("input",{type:"date",name:"assignedDate",value:a.assignedDate,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Status"}),e.jsxs("select",{name:"status",value:a.status,onChange:n,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:!0,children:[e.jsx("option",{value:"",children:"-- Select Status --"}),e.jsx("option",{value:"No Answer on Call",children:"No Answer on Call"}),e.jsx("option",{value:"Call Rescheduled",children:"Call Rescheduled"}),e.jsx("option",{value:"Information Pending to be Shared",children:"Information Pending to be Shared"}),e.jsx("option",{value:"Information Shared",children:"Information Shared"}),e.jsx("option",{value:"Follow-Up Needed",children:"Follow-Up Needed"}),e.jsx("option",{value:"Interested – Needs Further Clarification",children:"Interested – Needs Further Clarification"}),e.jsx("option",{value:"Not Interested",children:"Not Interested"}),e.jsx("option",{value:"Phone Unreachable / Switched Off",children:"Phone Unreachable / Switched Off"}),e.jsx("option",{value:"Lead Successfully Closed",children:"Lead Successfully Closed"}),e.jsx("option",{value:"Incorrect Contact Number",children:"Incorrect Contact Number"}),e.jsx("option",{value:"Call Pending",children:"Call Pending"})]})]}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto mt-6 bg-blue-600 text-white font-semibold px-6 py-3 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition",children:"Save Changes"})]})]})}export{q as default};
